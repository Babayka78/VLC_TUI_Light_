# –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ vlc-cec.sh

## ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢–°–Ø –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï –ü–ï–†–ï–î –ü–†–ò–ú–ï–ù–ï–ù–ò–ï–ú!

**–¶–µ–ª—å:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (3 –∏–∑–º–µ–Ω–µ–Ω–∏—è, 15 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞)

---

## –ò–∑–º–µ–Ω–µ–Ω–∏–µ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≤–µ—Ä—Å–∏–∏

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** –ü–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 18 (–ø–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è VIDEO_FILE)

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ (—Å—Ç—Ä–æ–∫–∏ 16-19):**
```bash
# –ò–∑–≤–ª–µ–∫–∞–µ–º –ø—É—Ç—å –∫ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—É
VIDEO_FILE="$FINAL_ARG"

# ============================================================
```

**–ß–¢–û –î–û–ë–ê–í–ò–¢–¨ (8 —Å—Ç—Ä–æ–∫):**
```bash
# –ò–∑–≤–ª–µ–∫–∞–µ–º –ø—É—Ç—å –∫ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—É
VIDEO_FILE="$FINAL_ARG"

# –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source "$SCRIPT_DIR/playback-tracker.sh"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
REQUIRED_TRACKER_VERSION="0.2.0"
if ! check_version_compatibility "$REQUIRED_TRACKER_VERSION"; then
    exit 1
fi

# ============================================================
```

**–ó–∞—á–µ–º:**
- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø—É—Ç–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤–µ—Ä—Å–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ (–∑–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫)
- –ï—Å–ª–∏ –≤–µ—Ä—Å–∏—è –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–∞ - —Å–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º

**–°—Ç—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–æ:** +8

---

## –ò–∑–º–µ–Ω–µ–Ω–∏–µ 2: –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ —Ñ–æ–Ω–µ

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** –ü–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 69 (–ø–æ—Å–ª–µ –≤—ã–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∑–∞–ø—É—Å–∫–µ)

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ (—Å—Ç—Ä–æ–∫–∏ 66-72):**
```bash
echo "‚úì VLC –∑–∞–ø—É—â–µ–Ω"
echo "‚úì RC –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: localhost:4212"
echo "‚úì CEC –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: $CEC_DEVICE"
echo ""
echo "üéÆ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—É–ª—å—Ç–∞ (–Ω–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–Ω–æ–ø–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)..."
echo ""

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ CEC —Å–æ–±—ã—Ç–∏–π
```

**–ß–¢–û –î–û–ë–ê–í–ò–¢–¨ (2 —Å—Ç—Ä–æ–∫–∏):**
```bash
echo "‚úì VLC –∑–∞–ø—É—â–µ–Ω"
echo "‚úì RC –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: localhost:4212"
echo "‚úì CEC –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: $CEC_DEVICE"
echo ""
echo "üéÆ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—É–ª—å—Ç–∞ (–Ω–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–Ω–æ–ø–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)..."
echo ""

# –ó–∞–ø—É—Å–∫–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ —Ñ–æ–Ω–µ
MONITOR_PID=$(monitor_vlc_playback "$VIDEO_FILE" $VLC_PID)

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ CEC —Å–æ–±—ã—Ç–∏–π
```

**–ó–∞—á–µ–º:**
- –°—Ç–∞—Ä—Ç—É–µ–º —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–∫–∞–∂–¥—ã–µ 60 —Å–µ–∫)
- –°–æ—Ö—Ä–∞–Ω—è–µ–º PID –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
- –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–æ, –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ VLC

**–°—Ç—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–æ:** +2

---

## –ò–∑–º–µ–Ω–µ–Ω–∏–µ 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ cleanup()

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** –°—Ç—Ä–æ–∫–∏ 334-341 (—Ñ—É–Ω–∫—Ü–∏—è cleanup)

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```bash
cleanup() {
    echo ""
    echo "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã..."
    kill $CEC_PID 2>/dev/null
    kill $VLC_PID 2>/dev/null
    pkill -P $$ 2>/dev/null
    exit 0
}
```

**–ó–ê–ú–ï–ù–ò–¢–¨ –ù–ê (13 —Å—Ç—Ä–æ–∫ –≤–º–µ—Å—Ç–æ 8):**
```bash
cleanup() {
    echo ""
    echo "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã..."
    
    # –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
    finalize_playback "$VIDEO_FILE"
    
    # –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å—ã
    kill $MONITOR_PID 2>/dev/null
    kill $CEC_PID 2>/dev/null
    kill $VLC_PID 2>/dev/null
    pkill -P $$ 2>/dev/null
    exit 0
}
```

**–ó–∞—á–µ–º:**
- –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º (—Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º "üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏: X%")
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ì–∞—Ä–∞–Ω—Ç–∏—è —á—Ç–æ –ø–æ–∑–∏—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ø—Ä–∏ –ª—é–±–æ–º –≤—ã—Ö–æ–¥–µ (BACK, Ctrl+C, –æ—à–∏–±–∫–∞)

**–°—Ç—Ä–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–æ:** 8 ‚Üí 13 (+5)

---

## üìä –ò—Ç–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ vlc-cec.sh:

| –ß—Ç–æ | –ì–¥–µ | –°—Ç—Ä–æ–∫ |
|-----|-----|-------|
| –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ + –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ | –ü–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 18 | +8 |
| –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | –ü–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 69 | +2 |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ cleanup() | –°—Ç—Ä–æ–∫–∏ 334-341 | +5 |
| **–í–°–ï–ì–û** | **3 –º–µ—Å—Ç–∞** | **+15** |

---

## ‚úÖ –ß—Ç–æ –ù–ï –º–µ–Ω—è–µ—Ç—Å—è:

- ‚ùå –õ–æ–≥–∏–∫–∞ –∑–∞–ø—É—Å–∫–∞ VLC - –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô
- ‚ùå CEC —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ - –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô
- ‚ùå –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ - –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô
- ‚ùå –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ - –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô

**–¢–æ–ª—å–∫–æ 15 —Å—Ç—Ä–æ–∫ –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞ –≤ 3 –º–µ—Å—Ç–∞—Ö!**

---

## üß™ –ß—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

1. ‚úÖ VLC –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω–æ
2. ‚úÖ –ö–∞–∂–¥—ã–µ 60 —Å–µ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–∑–∏—Ü–∏—è –≤ `.playback`
3. ‚úÖ –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ (BACK) - —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º
4. ‚úÖ –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ - –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
5. ‚úÖ –í—Å—è –ª–æ–≥–∏–∫–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ - –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û:

**–ü–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
1. –ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –±—ç–∫–∞–ø: `vlc-cec_V3_YYMMDD_HHMM.bak`
2. –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
3. –ï—Å–ª–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω - –æ—Ç–∫–∞—Ç –∏–∑ –±—ç–∫–∞–ø–∞

---

## ‚úã –ñ–¥—ë–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**–ì–æ—Ç–æ–≤ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è?**
- ‚úÖ –î–ê - –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ 3 –∏–∑–º–µ–Ω–µ–Ω–∏—è
- ‚ö†Ô∏è –ù–ï–¢ - –≤–Ω–µ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –≤ –ø–ª–∞–Ω
